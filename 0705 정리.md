# 예제1. 정보 저장하고 특정 값을 산출하기
## 1. 정보를 저장할 테이블을 데이터를 통해 구성하기
첫번째로 우리에게는 데이터파일이 주어졌습니다. 이것들을 이용하기 위해서 우리는 이 데이터들을 기반으로 테이블을 만들어야 합니다.

자, 파일을 열어 데이터를 봐 봅시다.
`('0','롯데백화점','9203101937988','2022-05-01 19:20:50','신한카드','일시불','37000','Y');`을 보고
어떻게 테이블을 만들어야하는지 정해야 합니다.

1) 첫번째는 인덱스를 의미하는 필드입니다. int(8)은 0부터 99999999까지 제한을 둡니다.또한 `auto_increment`를 사용함으로서 이 `p_idx`는 자동 고정값임을 선언하게 됩니다. 사용하게 될 경우 중복 값은 없으며 이 테이블을 초기화 할 경우 다시 데이터를 추가하게 되면 삭제하기 이전의 번호 직후부터 찍히게 됩니다. 또한 `primary key(해당 필드명)`을 같이 사용하여야 합니다.
2) 두번째는 구입처를 의미합니다.
3) 상품코드를 의미하는 것으로 보이며 이 경우 varchar을 사용합니다.**상품코드류**에 int를 사용하면 안되는 이유는, **int로 사용할 경우 상품코드중에 0으로 시작하는 경우 인식이 되지 않아 누락되는 경우가 생기게 됩니다.**
4) 구매한 시간을 의미하며 `datetime`과 `timestamp`중에 고민하게 될 텐데, 이 경우 카드사의 구매시간과 동일해야함으로 서버시간과 연동되는 `timestamp`대신 `datetime`을 사용해야 합니다.
5) 사용한 카드 종류를 의미합니다.
6) 할부개월을 의미합니다.
7) 상품 가격을 의미합니다. 이때는 **맨앞에 0이 있는 자료가 없기 때문에** int형을 사용해도 될것 같습니다.
8) 결제성공여부입니다. 이때 Y와 N과 C가 섞여 나오는데 이들을 하나의 묶음으로 묶어 표현하기 위해 `enum`이라는 명령어를 사용했습니다. 사용 후 뒤에 `default`라는 것을 이용해서 기본값을 설정하는데 보통은 결제가 성공하기 때문에 결제 거절과 결제 취소를 의미하는 'N'과 'C'를 추가로 바꿀수 있게 하고 기본값을 'Y'로 설정하였습니다.

``` MySQL
create table pay (
p_idx int(8) not null auto_increment,
p_place char (10) not null,
p_itemcode varchar(13) not null,
p_date datetime not null default '0001-01-01 01:00:00',
p_card varchar(100) not null,
p_divide char(40) not null,
p_price int(6) not null,
p_result enum ('Y','N','C') not null default 'Y',
primary key (p_idx)
);
```
또한 예제에 사용할 다른 Table도 생성하여줍니다. 이 의미는 위의 명령어와 유사하니 잘 읽을 수 있을 겁니다.
```MySQL
create table product(
c_no int(5) not null auto_increment,
c_code varchar(15) not null,
productname varchar(200) not null,
price int(6) not null,
c_result enum('Y','N','C') not null default 'Y',
primary key(c_no)
);
```
이것을 입력했을 때 `Query OK, 0 rows affected, 2 warnings (0.02 sec)`같은 것이 나온다면 성공한 것입니다.

### 2. 데이터 입력하기

테이블을 완성했다면 그 파일들에 `insert into 해당테이블명 values`라는 명령어를 붙여 투입 해봅시다.
```MySQL
insert into pay values('0','롯데백화점','9203101937988','2022-05-01 19:20:50','신한카드','일시불','37000','Y');
```
상기 명령어들을 table에 우르르 입력하게 되면 아래와 같은 table이 탄생하게 됩니다.

| p_idx | p_place      | p_itemcode    | p_date              | p_card   | p_divide | p_price |p_result|
|:-----:|:------------:|:-------------:|:-------------------:|----------|:--------:|:-------:|:------:|
|     1 | 롯데백화점   | 9203101937988 | 2022-05-01 19:20:50 | 신한카드 | 일시불   |   37000 | Y      |
|     2 | 현대백화점   | 0612329255417 | 2022-05-07 11:10:00 | 현대카드 | 일시불   |   19000 | Y      |
|     3 | 이마트인천점 | 9210233222339 | 2022-05-08 13:02:15 | 하나카드 | 2개월    |  118000 | Y      |
|     4 | 현대백화점   | 3611264692414 | 2022-05-08 17:12:55 | 신한카드 | 일시불   |  248000 | Y      |
|     5 | 롯데백화점   | 2456781123245 | 2022-05-10 13:12:55 | 국민카드 | 3개월    |  154800 | Y      |
|     6 | 이마트인천점 | 5678818234496 | 2022-05-10 17:09:51 | 현대카드 | 일시불   |   24000 | Y      |
|     7 | 롯데백화점   | 7656462265410 | 2022-05-11 14:12:55 | 신한카드 | 일시불   |   61000 | Y      |
|     8 | 롯데백화점   | 0612329255417 | 2022-05-12 15:32:50 | 신한카드 | 일시불   |   19000 | Y      |
|     9 | 이마트마곡점 | 1263656514459 | 2022-05-19 16:07:44 | 하나카드 | 2개월    |   76000 | Y      |
|    10 | 롯데백화점   | 8766545233212 | 2022-05-20 16:16:55 | 현대카드 | 일시불   |   58900 | Y      |
|    11 | 이마트마곡점 | 7612323337489 | 2022-05-20 16:12:55 | 신한카드 | 일시불   |   32500 | Y      |
|    12 | 롯데백화점   | 9331312245524 | 2022-05-21 10:12:50 | 신한카드 | 3개월    |  228700 | Y      |
|    13 | 현대백화점   | 7656462265410 | 2022-05-21 11:12:45 | 롯데카드 | 일시불   |   61000 | Y      |
|    14 | 현대백화점   | 5678818234496 | 2022-05-21 13:42:35 | 하나카드 | 일시불   |   24000 | Y      |
|    15 | 롯데백화점   | 9203101937988 | 2022-05-21 14:52:54 | 국민카드 | 일시불   |   37000 | Y      |
|    16 | 이마트마곡점 | 3611264692414 | 2022-05-22 16:32:52 | 하나카드 | 2개월    |  248000 | Y      |
|    17 | 롯데백화점   | 5678818234496 | 2022-05-22 17:49:51 | 현대카드 | 일시불   |   24000 | Y      |
|    18 | 이마트화곡점 | 9203101937988 | 2022-01-07 13:12:55 | 롯데카드 | 2개월    |   37000 | Y      |


## 3. 특정 값을 뽑아봅시다.

![응용문제 2](/assets/응용문제%202_ewwxr2760.JPG)
![응용문제 3](/assets/응용문제%203_kdxabgysl.JPG)

#### Sum / order by / group by / join
사진에 나온 명령어를 하나하나 쪼개 봅시다.

##### sum
일단 첫번째로 **특정 필드의 합을 표현** 하기 위해서 `select sum(필드명) from 테이블명`이라는 명령어를 사용해야 합니다. 이 경우에 필드속성은 당연히 **int(숫자)** 로 이루어져 있어야 덧셈을 하든 뭐라도 하겠죠.

그리고 추후에 가장 많이 산 사람을 뽑는 등의 내림,오름차순이 필요할 때가 생길겁니다.
그때 `select * from 테이블명 order by 필드명 desc => 내림차순 / asc => 오름차순`이라는 명령어를 사용하면 됩니다.

##### group by
`group by 필드명` => 해당 같은 이름을 가진 **그룹별로 각각 값을 합친 데이터를 출력**하는 명령어입니다.
아래 명령어와 같이 사용합니다.
```MySQL
select 필드명 ,sum(필드명) as 가상의 필드명 from 테이블명 group by 필드명;
```

##### join
`join`은 단어 그대로 **원하는 테이블의 필드끼리 합쳐서 출력**하게 하는 명령어입니다. 이 명령어를 쓰면 필요한 자료들만 뽑아 적재적소에 사용이 가능하게 됩니다.
select `조인테이블(필드명)` from `본테이블` as `가상 생성자` join `비교테이블` as `가상 생성자2` on `가상생성자.필드명` = `가상생성자2.필드명`

서로 다른 테이블의 특정 필드들만 join할때는 아래의 코드를 이용합니다.
```MySQL
select `필드명` from `테이블명` as `가상의 필드명1` join `테이블명` as `가상의 테이블명2` on `가상의 테이블명1.필드명` = `가상의테이블명2.필드명` where `가상의테이블명.필드명`
```
